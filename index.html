<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>朝比奈非公式bot（美夜ボタン）</title>
  <script src="https://code.jquery.com/jquery-1.10.1.min.js"></script>
  <link href="https://fonts.googleapis.com/css?family=M+PLUS+1p" rel="stylesheet">
  <script defer src="https://use.fontawesome.com/releases/v5.0.4/js/all.js"></script>
  <link rel="stylesheet" href="css/styles.css">

  <!-- OG -->
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:image" content="https://lait-au-cafe.github.io/asahina_bot/img/preview.png"/>
  <meta name="og:url" content="https://lait-au-cafe.github.io/asahina_bot/"/>
  <meta name="og:title" content="朝比奈非公式bot（美夜ボタン）"/>
  <meta name="og:description" content="このサイトはVTuber朝比奈美夜さんのファンサイトです．Twitchの配信からの切り抜き及び朝比奈さんから直接いただいた素材を利用しています．"/>
  <meta name="og:image:secure_url" content="https://lait-au-cafe.github.io/asahina_bot/img/preview.png"/>
  <meta name="og:image:type" content="image/png"/>
</head>
<body>
    <header>
        <h1>課題に旅立った朝比奈の枠を埋める非公式Bot</h1>
        <div id="intro">
            <div id="profile">
                <div id="portrait">
                    <img src="https://pbs.twimg.com/profile_images/1245398911407161345/Eky-YPiz_400x400.png">
                </div>
                <p>朝比奈美夜🌼🌙Vtuber</p>
                <ul>
                    <li><a href="https://www.youtube.com/channel/UClZSrbwsiipeL6BNv1F2SLw" target="_blank"><img src="icons/youtube.png"></a></li>
                    <li><a href="https://twitter.com/asahinamiya" target="_blank"><img src="icons/twitter.png"></a></li>
                    <li><a href="https://www.twitch.tv/asahinamiya/" target="_blank"><img src="icons/twitch.png"></a></li>
                    <li><a href="https://asahinamiya.booth.pm/" target="_blank"><img src="icons/booth.png" style="max-width: none;"></a></li>
                </ul>
            </div>
            <div id="comment">
                <p>こんばんみゃー！</p>
                <p>個人VTuberグループ【Date+Links!】所属</p>
                <p>一期生の朝比奈美夜です！</p>
                <p>Botやってます！</p>
                <p style="text-align: right;">―「自己紹介」より</p>
            </div>
        </div>
        <div id="description">
            <p>このサイトはVTuber朝比奈美夜さんのファンサイトです．
            Twitchの配信からの切り抜き及び朝比奈さんから直接いただいた素材を利用しています．
            現状朝比奈さんのご厚意により容認していただいていますが，朝比奈さんの名誉を棄損するような目的では利用しないようお願いいたします．
            当サイトにより問題が生じた場合は直ちに閉鎖いたします．
            ルールを守って楽しいbot!! ボイスを聞いて可愛いと思ったそこのあなた!! Boothにボイスが売ってるぞ!! 今すぐGO!!</p>
            <p>このページをシェアする→
                <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-text="朝比奈非公式bot（美夜ボタン）" data-url="https://lait-au-cafe.github.io/asahina_bot/" data-hashtags="美夜ボタン" data-dnt="true">Tweet</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
            </p>
        </div>
    </header>
    <div class="container">
        <div class="side_bar">
            <div id="controller">
                <ul>
                    <li id="play_all_btn">再生</li>
                    <li id="remove_all_btn">全消去</li>
                </ul>
            </div>
            <div id="playlist" dropzone="copy">
                ここにボタンをドラッグすると連続再生ができます．
            </div>
        </div>
        <div class="main">
            <div class="search_area">
                <div class="search">
                    <p>フィルタ：</p>
                    <input id="filter_input_area" type="text">
                    <p><span class="hit_cnt"></span>件</p>
                </div>
            </div>
            <div class="button_area">
                <!-- Standard -->
                <div class="button basic">
                    <p>自己紹介</p>
                    <audio src="audio/intro.wav"></audio>
                </div>
                <div class="button basic">
                    <p>こんばんみゃー!</p>
                    <audio src="audio/greeting.wav"></audio>
                </div>
                <div class="button basic">
                    <p>ナイスですっ!!</p>
                    <audio src="audio/nice.wav"></audio>
                </div>
                <div class="button basic">
                    <p>GG!!</p>
                    <audio src="audio/gg.wav"></audio>
                </div>
                <div class="button basic">
                    <p>あらあら</p>
                    <audio src="audio/arar.wav"></audio>
                </div>
                <div class="button basic">
                    <p>お可愛いこと</p>
                    <audio src="audio/so_cute.wav"></audio>
                </div>
                
                <!-- Short replies -->
                <div class="button reply">
                    <p>はい!</p>
                    <audio src="audio/yes.wav"></audio>
                </div>
                <div class="button reply">
                    <p>了解です</p>
                    <audio src="audio/roger.wav"></audio>
                </div>
                <div class="button reply">
                    <p>わかる</p>
                    <audio src="audio/agree.wav"></audio>
                </div>
                <div class="button reply">
                    <p>なるほどぉ!</p>
                    <audio src="audio/igotit.wav"></audio>
                </div>
                <div class="button reply">
                    <p>やったー!</p>
                    <audio src="audio/ididit.wav"></audio>
                </div>
                <div class="button reply">
                    <p>ふん!</p>
                    <audio src="audio/hun.wav"></audio>
                </div>
                <div class="button reply">
                    <p>やだ!</p>
                    <audio src="audio/yada.wav"></audio>
                </div>
                <div class="button reply">
                    <p>はぁ?</p>
                    <audio src="audio/what.wav"></audio>
                </div>
                <div class="button reply">
                    <p>ｱﾊｰw</p>
                    <audio src="audio/aha.wav"></audio>
                </div>
                <div class="button reply">
                    <p>ｱﾊﾊﾊw</p>
                    <audio src="audio/laugh.wav"></audio>
                </div>
                <div class="button reply">
                    <p>ひょえ～</p>
                    <audio src="audio/hyoe.wav"></audio>
                </div>
                <div class="button reply">
                    <p>ああいいっすね</p>
                    <audio src="audio/fine.wav"></audio>
                </div>
                <div class="button reply">
                    <p>まじぃ～？</p>
                    <audio src="audio/really.wav"></audio>
                </div>
                <div class="button reply">
                    <p>でしょ？</p>
                    <audio src="audio/right.wav"></audio>
                </div>
                <div class="button reply">
                    <p>どした～？</p>
                    <audio src="audio/whatswrong.wav"></audio>
                </div>
                <div class="button reply">
                    <p>なんですかぁ～？</p>
                    <audio src="audio/whatsup.wav"></audio>
                </div>
                <div class="button reply">
                    <p>えっ</p>
                    <audio src="audio/e.wav"></audio>
                </div>
                <div class="button reply">
                    <p>えええ</p>
                    <audio src="audio/eee.wav"></audio>
                </div>
                <div class="button reply">
                    <p>ねえ</p>
                    <audio src="audio/nee2.wav"></audio>
                </div>
                <div class="button reply">
                    <p>なんて？</p>
                    <audio src="audio/pardon.wav"></audio>
                </div>
                <div class="button reply">
                    <p>いいんですか？</p>
                    <audio src="audio/isthatok.wav"></audio>
                </div>
                <div class="button reply">
                    <p>投げキッス</p><p>（舌打ち）</p>
                    <audio src="audio/kiss.wav"></audio>
                </div>
                <div class="button reply">
                    <p>ふぁっきゅー!</p>
                    <audio src="audio/fk.wav"></audio>
                </div>
    
                <!-- Casual lines -->
                <div class="button">
                    <p>なーに?</p>
                    <audio src="audio/na-ni.wav"></audio>
                </div>
                <div class="button">
                    <p>普通だよ</p>
                    <audio src="audio/itsnormal.wav"></audio>
                </div>
                <div class="button">
                    <p>かしこい!</p>
                    <audio src="audio/smart.wav"></audio>
                </div>
                <div class="button">
                    <p>大丈夫か？</p>
                    <audio src="audio/areyouok.wav"></audio>
                </div>
                <div class="button">
                    <p>ドンマイです!</p>
                    <audio src="audio/nevermind.wav"></audio>
                </div>
                <div class="button">
                    <p>大丈夫ですって</p>
                    <audio src="audio/np.wav"></audio>
                </div>
                <div class="button">
                    <p>私がいるんで</p>
                    <audio src="audio/imonyou.wav"></audio>
                </div>
                <div class="button">
                    <p>…ダメすかね</p>
                    <audio src="audio/somethingwrongwiththat.wav"></audio>
                </div>
                <div class="button">
                    <p>許される?</p>
                    <audio src="audio/forgiven.wav"></audio>
                </div>
                <div class="button">
                    <p>忘れないで</p>
                    <audio src="audio/dont_forget.wav"></audio>
                </div>
                <div class="button">
                    <p>こわーい</p>
                    <audio src="audio/fear.wav"></audio>
                </div>
                <div class="button">
                    <p>うぇ～いww</p>
                    <audio src="audio/wei-001.wav"></audio>
                </div>
                <div class="button">
                    <p>あぶね～w</p>
                    <audio src="audio/danger.wav"></audio>
                </div>
                <div class="button">
                    <p>やったな…w</p>
                    <audio src="audio/yattana.wav"></audio>
                </div>
                <div class="button">
                    <p>最悪w</p>
                    <audio src="audio/so_bad.wav"></audio>
                </div>
                <div class="button">
                    <p>いやきっ…m</p>
                    <audio src="audio/gross.wav"></audio>
                </div>
                <div class="button">
                    <p>ホントにゴミね</p>
                    <audio src="audio/reallytrash.wav"></audio>
                </div>
                <div class="button">
                    <p>ママ～?</p>
                    <audio src="audio/mama.wav"></audio>
                </div>
                <div class="button">
                    <p>パパ!</p>
                    <audio src="audio/papa3.wav"></audio>
                </div>
                <div class="button">
                    <p>はらへった</p>
                    <audio src="audio/hungry.wav"></audio>
                </div>
                <div class="button">
                    <p>任せてくださいよ</p>
                    <audio src="audio/leave_it_to_me.wav"></audio>
                </div>
                <div class="button">
                    <p>面白いこと言いますね</p>
                    <audio src="audio/interesting.wav"></audio>
                </div>
    
                <!-- Longer lines -->
                <div class="button longer">
                    <p>フォローありがとうございます!</p>
                    <audio src="audio/thx_for_following.wav"></audio>
                </div>
                <div class="button longer">
                    <p>感謝します!</p>
                    <audio src="audio/appreciate.wav"></audio>
                </div>
                <div class="button longer">
                    <p>せんきゅ!</p>
                    <audio src="audio/thx.wav"></audio>
                </div>
                <div class="button longer">
                    <p>死んでる～w</p>
                    <audio src="audio/dying.wav"></audio>
                </div>
                <div class="button longer">
                    <p>死んできます!!</p>
                    <audio src="audio/gonna_die.wav"></audio>
                </div>
                <div class="button longer">
                    <p>死んでもろてええかぁ!?</p>
                    <audio src="audio/wouldyoudie.wav"></audio>
                </div>
                <div class="button longer">
                    <p>痛いってだから!!</p>
                    <audio src="audio/ithurts.wav"></audio>
                </div>
                <div class="button longer">
                    <p>やめなさいって言ってるでしょうがぁ!</p>
                    <audio src="audio/isaystopit.wav"></audio>
                </div>
                <div class="button longer">
                    <p>火葬される!</p>
                    <audio src="audio/gannaburn.wav"></audio>
                </div>
                <div class="button longer">
                    <p>でっけぇ虫いんな</p>
                    <audio src="audio/big_bug.wav"></audio>
                </div>
                <div class="button longer">
                    <p>いらっしゃいませ～</p>
                    <audio src="audio/welcome.wav"></audio>
                </div>
                <div class="button longer">
                    <p>認知してぇ!</p>
                    <audio src="audio/accept.wav"></audio>
                </div>
                <div class="button longer">
                    <p>育て方が良かったんかなやっぱ</p>
                    <audio src="audio/igrew.wav"></audio>
                </div>
                <div class="button longer">
                    <p>男の子として生きていけばいい?</p>
                    <audio src="audio/liveasboy.wav"></audio>
                </div>
                <div class="button longer">
                    <p>はぁ!?ナメてんのぉ??</p>
                    <audio src="audio/nameteru.wav"></audio>
                </div>
                <div class="button longer">
                    <p>botです!!</p>
                    <audio src="audio/imbot.wav"></audio>
                </div>
    
                <!-- Special lines -->
                <div class="button special">
                    <p>啼け</p>
                    <p>(なかひろ)チーズ</p>
                    <audio src="audio/cheese_sum2.wav"></audio>
                </div>
            </div>
        </div>
    </div>
    <script>
        (function(){
            'use strict';

            $('.button_area .button').each((i, elem) => {
                // set click event (audio play)
                $(elem).on('click', () => {
                    let audio = $(elem).find('audio').get(0);
                    audio.onended = () => {
                        $(elem).removeClass('target');
                    }
                    $(elem).addClass('target');
                    audio.play();
                });

                // set drag event
                elem.setAttribute('draggable', true);
                $(elem).on('dragstart', (e) => {
                    e.originalEvent.dataTransfer.setData('text/html', elem.outerHTML);
                });
            });
            
            $('#playlist').on('dragenter', (e) => {
                if(!is_locked) {
                    $('#playlist').addClass('mark');
                }
            });
            $('#playlist').on('dragleave', (e) => {
                $('#playlist').removeClass('mark');
            });
            $('#playlist').on('dragover', (e) => {
                e.originalEvent.preventDefault();
            });
            
            let is_locked = false; // I wish this variable doesn't cause race condition. 
            $('#playlist').on('drop', (e) => {
                $('#playlist').removeClass('mark');
                if(!is_locked) {
                    let template = document.createElement('template');
                    template.innerHTML = e.originalEvent.dataTransfer.getData('text/html');
                    let btn_body = template.content.firstChild;
                    btn_body.setAttribute('draggable', false);

                    template = document.createElement('template');
                    template.innerHTML = '<div class="remove_btn"><i class="far fa-trash-alt"></i></div>';
                    let remove_btn = template.content.firstChild;
                    $(remove_btn).on('click', () => {
                        $(btn_body).remove();
                    });

                    btn_body.appendChild(remove_btn);
                    $('#playlist').append(btn_body);
                }
            });

            $('#play_all_btn').on('click', () => {
                // lock edit
                is_locked = true;
                $('#playlist').addClass('playing');

                // collect audios
                let audios = [];
                $('#playlist .button').each((i, elem) => {
                    audios.push($(elem).find('audio').get(0));
                });

                let num_of_audios = audios.length;
                if(num_of_audios <= 0) {
                    // unlock and exit
                    is_locked = false;
                    $('#playlist').removeClass('playing');
                    return;
                }

                for(let i = 0; i < num_of_audios; i++) {
                    audios[i].onended = () => {
                        $($('#playlist .button')[i]).removeClass('target');
                        if(i+1 < num_of_audios) {
                            // click next elem
                            $($('#playlist .button')[i+1]).addClass('target');
                            audios[i+1].play();
                        }
                        else {
                            // unlock and exit
                            is_locked = false;
                            $('#playlist').removeClass('playing');
                        }
                    }
                }

                $($('#playlist .button')[0]).addClass('target');
                audios[0].play();
            });
            $('#remove_all_btn').on('click', () => {
                if(!is_locked){
                    $('#playlist .button').remove();
                }
            });

            $('.button_area').on('dragover', (e) => {
                e.originalEvent.preventDefault();
            });

            const filter_input_area = $('#filter_input_area');
            filter_input_area.on('input', (e) => {
                // reset
                $('.button_area .button.hidden').each((i, elem) => {
                    $(elem).removeClass('hidden');
                });

                // add class those who don't contain keyword. 
                const filter_word = filter_input_area.val();
                let hit_cnt = 0;
                $('.button_area .button').each((i, elem) => {
                    const voice_name = $(elem).find('p').html();
                    if(!voice_name.includes(filter_word)) {
                        $(elem).addClass('hidden');
                    }
                    else {
                        hit_cnt++;
                    }
                });
                $('.search .hit_cnt').html(hit_cnt);
            });
            $('.search .hit_cnt').html($('.button_area .button').length);
        }());
    </script>
</body>
</html>
